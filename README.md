[![Coverage Status](https://coveralls.io/repos/github/beliaev-aa/GophKeeper/badge.svg?branch=master)](https://coveralls.io/github/beliaev-aa/GophKeeper?branch=master)
# GophKeeper

GophKeeper — это приложение для управления секретами, которое позволяет пользователям безопасно хранить и управлять
личной информацией.

Это дипломный проект в рамках курса "Продвинутый Go-разработчик" от Яндекс.Практикум. 
Состоит из:
- сервера
- клиента


## Содержание

- [Основная функциональность](#основная-функциональность)
- [Установка](#установка)
- [Настройка переменных окружения](#настройка-переменных-окружения)
- [Использование](#использование)
- [Зависимости](#зависимости)
- [Запуск сервера с помощью Docker](#запуск-сервера-с-помощью-Docker)

## Основная функциональность

### Сервер

Сервер приложения `GophKeeper` реализует важные аспекты бизнес-логики, обеспечивающие безопасность и удобство работы с приватными данными пользователей:

- **Регистрация, аутентификация и авторизация пользователей**: Сервер обеспечивает возможность регистрации новых пользователей, а также их аутентификацию и авторизацию для доступа к функциям системы.
- **Хранение приватных данных**: Все приватные данные пользователей хранятся в зашифрованном виде, обеспечивая их безопасность от несанкционированного доступа.
- **Синхронизация данных между несколькими авторизованными клиентами одного владельца**: Сервер поддерживает синхронизацию данных между различными устройствами пользователя, что позволяет обеспечить актуальность информации на всех подключенных устройствах.
- **Передача приватных данных владельцу по запросу**: Пользователи могут запрашивать свои данные с сервера, который обеспечивает их передачу в безопасном и контролируемом формате.

### Клиент

Клиентская часть приложения `GophKeeper` также включает в себя ряд функций для интерактивной работы с сервером:

- **Аутентификация и авторизация пользователей на удалённом сервере**: Клиент поддерживает процессы аутентификации и авторизации, что позволяет пользователям безопасно входить в систему и получать доступ к своим данным.
- **Доступ к приватным данным по запросу**: После успешной аутентификации пользователи могут запрашивать и получать доступ к своим приватным данным, хранящимся на сервере.

Эти функции обеспечивают основу для защищённого хранения и управления приватной информацией в рамках приложения `GophKeeper`.


## Установка

Для начала убедитесь, что у вас установлены `go` и `protoc` (Protobuf compiler).

1. Клонируйте репозиторий:
   ```bash
   git clone https://github.com/beliaev-aa/GophKeeper.git
   cd GophKeeper
   ```

2. Сгенерируйте код из protobuf файлов:
   ```bash
   make proto
   ```

3. Сгенерируйте сертификаты:
   ```bash
   make cert
   ```

## Настройка переменных окружения

Перед запуском сервера необходимо настроить переменные окружения, чтобы обеспечить правильную конфигурацию и безопасность приложения. Ниже приведены ключевые переменные, которые нужно настроить:

- `GOPHKEEPER_POSTGRES_DSN` - строка подключения к базе данных PostgreSQL, например: `postgres://user:password@postgres:5432/dbname?sslmode=disable`
- `GOPHKEEPER_ADDRESS` - адрес и порт, на котором сервер будет доступен, например: `127.0.0.1:50051`
- `GOPHKEEPER_SECRET_KEY` - секретный ключ для шифрования, например: `super_secret_key`

Эти переменные можно задать непосредственно в вашем окружении или в файле `.env`, который используется Docker-контейнером и приложением для считывания конфигурации.

Перед запуском клиента необходимо настроить переменную окружения, чтобы обеспечить правильную конфигурацию.

- `GOPHKEEPER_ADDRESS` - адрес и порт сервера, к которому клиент будет подключаться. Например: `server:50051`. По умолчанию, если переменная не задана, будет использован адрес `127.0.0.1:50051`.

Убедитесь, что переменные окружения заданы перед запуском клиента, чтобы обеспечить его правильную работу и взаимодействие с сервером.


## Использование

Для сборки и запуска приложения используйте следующие команды:

- Сборка сервера:
   ```bash 
   make server
   ```

- Сборка клиента:
   ```bash 
   make client
   ```

- Сборка клиента и сервера одной командой:
   ```bash 
   make build
   ```

- Тестирование:
   ```bash 
   make test
   ```

- Получение отчета о покрытии кода тестами:
   ```bash 
   make coverage
   ```

- Получение HTML отчета о покрытии кода тестами:
   ```bash 
   make coverage-html
   ```

- Для получения списка всех доступных команд выполните:
   ```bash 
   make help 
   ```

### Миграции
Сервер автоматически применит новые миграции при запуске.
Новые миграции можно добавить с помощью goose в директорию `internal/server/storage/migrations`

## Зависимости

Проект использует следующие внешние библиотеки:

- github.com/atotto/clipboard - для работы с буфером обмена
- github.com/charmbracelet/bubbles и github.com/charmbracelet/bubbletea - для пользовательского интерфейса
- github.com/golang-jwt/jwt/v4 - для работы с JWT
- github.com/jmoiron/sqlx и github.com/jackc/pgx/v5 - для работы с базами данных PostgreSQL
- go.uber.org/zap - для логгирования
- google.golang.org/grpc - для gRPC вызовов

## Запуск сервера с помощью Docker

Для запуска приложения с помощью Docker:

1. Создайте файл .env на основании .env.dist с вашими параметрами:
   ```bash 
   cp .env.dist .env
   # Затем отредактируйте .env файл с вашими настройками
   ```

2. Запустите Docker контейнеры:
   ```bash 
   docker-compose up -d --build 
   ```
